const SitesJS={requestAPI:(e,t,r)=>{let s=5;!function n(){return new Promise(((a,o)=>{let c=0,i=setTimeout((()=>{0===c&&(c=2,i=null,o("请求超时"),0==s&&r())}),5e3);fetch(e).then((function(e){if(2!==c&&(clearTimeout(i),a(e),i=null,c=1),e.ok)return e.json();throw new Error("Network response was not ok.")})).then((function(e){s=0,t(e)})).catch((function(e){s>0?(s-=1,setTimeout((()=>{n()}),5e3)):r()}))}))}()},layout:e=>{const t=e.el;SitesJS.requestAPI(e.api,(function(r){t.querySelector(".loading-wrap").remove();const s=r.content;var n="";s.forEach(((t,r)=>{var s='<div class="site-card">';s+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+t.url+'">',s+='<img alt="'+t.title+'" src="'+(t.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+t.url)+'" onerror="javascript:this.src=\''+e.screenshot+"';\"/>",s+='<div class="info">',s+='<img alt="'+t.title+'" src="'+(t.avatar||e.avatar)+'" onerror="javascript:this.src=\''+e.avatar+"';\"/>",s+='<span class="title">'+t.title+"</span>",s+='<span class="desc">'+(t.description||t.url)+"</span>",s+="</div>",s+="</a>",n+=s+="</div>"})),t.querySelector(".group-body").innerHTML=n}),(function(){try{t.querySelector(".loading-wrap svg").remove(),t.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}}))},start:e=>{const t=document.getElementsByClassName("sitesjs-wrap");for(var r=0;r<t.length;r++){const s=t[r],n=s.getAttribute("api");if(null!=n)(e=new Object).class=s.getAttribute("class"),e.el=s,e.api=n,e.avatar="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/link/8f277b4ee0ecd.svg",e.screenshot="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/cover/76b86c0226ffd.svg",SitesJS.layout(e)}}};SitesJS.start(),document.addEventListener("pjax:complete",(function(){SitesJS.start()}));